<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binance-Style Trading Interface</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #0c0e14;
            color: #eaecef;
            overflow: hidden;
        }
        
        .container {
            display: grid;
            grid-template-columns: 280px 1fr 300px;
            grid-template-rows: 60px 1fr 240px;
            height: 100vh;
            gap: 1px;
            background-color: #161a25;
        }
        
        .header {
            grid-column: 1 / 4;
            background-color: #161a25;
            border-bottom: 1px solid #252931;
            display: flex;
            align-items: center;
            padding: 0 20px;
            justify-content: space-between;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            font-size: 20px;
            color: #f0b90b;
        }
        
        .symbol-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .symbol {
            font-size: 20px;
            font-weight: bold;
        }
        
        .price {
            font-size: 20px;
            font-weight: bold;
            color: #00b15d;
        }
        
        .negative {
            color: #f84960;
        }
        
        .change {
            color: #00b15d;
            font-size: 14px;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .btn {
            background-color: #2b3139;
            border: none;
            color: #eaecef;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-primary {
            background-color: #f0b90b;
            color: #0c0e14;
        }
        
        .btn-danger {
            background-color: #f84960;
            color: white;
        }
        
        .connection-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .status-connected {
            background-color: #00cc00;
        }
        
        .status-disconnected {
            background-color: #ff3333;
        }
        
        .status-connecting {
            background-color: #ffcc00;
        }
        
        .sidebar {
            background-color: #161a25;
            border-right: 1px solid #252931;
            padding: 15px;
            overflow-y: auto;
        }
        
        .favorites {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 14px;
            color: #848e9c;
            margin-bottom: 10px;
            text-transform: uppercase;
        }
        
        .market-list {
            list-style: none;
        }
        
        .market-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            cursor: pointer;
            border-bottom: 1px solid #252931;
        }
        
        .market-item:hover {
            background-color: #1e222d;
        }
        
        .market-name {
            font-weight: 500;
        }
        
        .market-price {
            color: #00b15d;
        }
        
        .market-change {
            color: #00b15d;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            background-color: #0c0e14;
        }
        
        .chart-container {
            flex: 1;
            position: relative;
        }
        
        #chart {
            width: 100%;
            height: 100%;
        }
        
        .chart-toolbar {
            position: absolute;
            top: 15px;
            left: 15px;
            z-index: 10;
            display: flex;
            gap: 8px;
            background-color: #1c2030;
            padding: 6px;
            border-radius: 4px;
        }
        
        .time-intervals {
            display: flex;
            background-color: #2b3139;
            border-radius: 4px;
            padding: 15px;
            gap: 5px;
        }
        
        .interval {
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
        }
        
        .interval.active {
            background-color: #f0b90b;
            color: #0c0e14;
        }
        
        .trading-pair {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid #252931;
        }
        
        .order-book {
            background-color: #161a25;
            border-left: 1px solid #252931;
            display: flex;
            flex-direction: column;
        }
        
        .order-book-header {
            padding: 15px;
            border-bottom: 1px solid #252931;
            font-weight: 500;
        }
        
        .order-book-content {
            flex: 1;
            overflow-y: auto;
            padding: 0 15px;
        }
        
        .order-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #252931;
        }
        
        .order-price {
            color: #00b15d;
        }
        
        .order-amount {
            color: #eaecef;
        }
        
        .order-total {
            color: #848e9c;
        }
        
        .order-row.sell .order-price {
            color: #f84960;
        }
        
        .current-price {
            text-align: center;
            padding: 10px;
            background-color: #1c2030;
            font-weight: bold;
            font-size: 18px;
            color: #f0b90b;
        }
        
        .trade-history {
            grid-column: 1 / 4;
            background-color: #161a25;
            border-top: 1px solid #252931;
            padding: 15px;
            overflow-y: auto;
        }
        
        .trade-history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .trades-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .trades-table th {
            text-align: left;
            padding: 10px 5px;
            color: #848e9c;
            font-weight: 500;
        }
        
        .trades-table td {
            padding: 8px 5px;
            border-bottom: 1px solid #252931;
        }
        
        .trades-table .price {
            color: #00b15d;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 200px 1fr 250px;
            }
        }
        
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
                grid-template-rows: 60px auto auto auto;
            }
            
            .sidebar, .order-book {
                display: none;
            }
            
            .header {
                grid-column: 1;
            }
            
            .trade-history {
                grid-column: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <i class="fas fa-coins"></i>
                <span>Binance</span>
            </div>
            <div class="symbol-info">
                <div class="symbol">BTC/USDT</div>
                <div class="price" id="current-price">36,542.50</div>
                <div class="change" id="price-change">+2.45%</div>
            </div>
            <div class="header-actions">
                <div class="connection-status">
                    <div class="status-indicator status-disconnected" id="status-indicator"></div>
                    <span id="status-text">Disconnected</span>
                </div>
                <button class="btn btn-primary" id="connectBtn"><i class="fas fa-wifi"></i> Connect</button>
                <button class="btn"><i class="fas fa-wallet"></i> Wallet</button>
                <button class="btn"><i class="fas fa-exchange-alt"></i> Trade</button>
            </div>
        </div>
        
        <div class="sidebar">
            <div class="favorites">
                <div class="section-title">Favorites</div>
                <ul class="market-list">
                    <li class="market-item">
                        <span class="market-name">BTC/USDT</span>
                        <span class="market-price">36,542.50</span>
                        <span class="market-change">+2.45%</span>
                    </li>
                    <li class="market-item">
                        <span class="market-name">ETH/USDT</span>
                        <span class="market-price">2,045.20</span>
                        <span class="market-change">+1.87%</span>
                    </li>
                    <li class="market-item">
                        <span class="market-name">BNB/USDT</span>
                        <span class="market-price">315.75</span>
                        <span class="market-change negative">-0.35%</span>
                    </li>
                    <li class="market-item">
                        <span class="market-name">SOL/USDT</span>
                        <span class="market-price">102.40</span>
                        <span class="market-change">+5.22%</span>
                    </li>
                </ul>
            </div>
            
            <div class="markets">
                <div class="section-title">Markets</div>
                <ul class="market-list">
                    <li class="market-item">
                        <span class="market-name">BTC/USDT</span>
                        <span class="market-price">36,542.50</span>
                        <span class="market-change">+2.45%</span>
                    </li>
                    <li class="market-item">
                        <span class="market-name">ETH/USDT</span>
                        <span class="market-price">2,045.20</span>
                        <span class="market-change">+1.87%</span>
                    </li>
                    <li class="market-item">
                        <span class="market-name">XRP/USDT</span>
                        <span class="market-price">0.6325</span>
                        <span class="market-change negative">-1.05%</span>
                    </li>
                    <li class="market-item">
                        <span class="market-name">ADA/USDT</span>
                        <span class="market-price">0.4521</span>
                        <span class="market-change">+0.82%</span>
                    </li>
                    <li class="market-item">
                        <span class="market-name">DOT/USDT</span>
                        <span class="market-price">5.24</span>
                        <span class="market-change negative">-0.45%</span>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="main-content">
            <div class="trading-pair">
                <div class="time-intervals">
                    <div class="interval active" data-interval="1m">1m</div>
                    <div class="interval" data-interval="5m">5m</div>
                    <div class="interval" data-interval="15m">15m</div>
                    <div class="interval" data-interval="1h">1h</div>
                    <div class="interval" data-interval="4h">4h</div>
                    <div class="interval" data-interval="1d">1d</div>
                    <div class="interval" data-interval="1w">1w</div>
                </div>
                <div class="chart-options">
                    <button class="btn"><i class="fas fa-cog"></i> Indicators</button>
                </div>
            </div>
            <div class="chart-container">
                <div class="chart-toolbar">
                    <button class="btn"><i class="fas fa-line-chart"></i> Line</button>
                    <button class="btn"><i class="fas fa-bars"></i> Candles</button>
                </div>
                <div id="chart"></div>
            </div>
        </div>
        
        <div class="order-book">
            <div class="order-book-header">Order Book</div>
            <div class="order-book-content" id="order-book-content">
                <!-- Order book data will be populated here -->
            </div>
        </div>
        
        <div class="trade-history">
            <div class="trade-history-header">
                <div class="section-title">Market Trades</div>
                <button class="btn"><i class="fas fa-refresh"></i> Refresh</button>
            </div>
            <table class="trades-table">
                <thead>
                    <tr>
                        <th>Price (USDT)</th>
                        <th>Amount (BTC)</th>
                        <th>Time</th>
                    </tr>
                </thead>
                <tbody id="trades-body">
                    <!-- Trade data will be populated here -->
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://unpkg.com/lightweight-charts@4.0.1/dist/lightweight-charts.standalone.production.js"></script>
    <script>
        // Initialize chart
        const chart = LightweightCharts.createChart(document.getElementById('chart'), {
            width: document.getElementById('chart').clientWidth,
            height: document.getElementById('chart').clientHeight,
            layout: {
                backgroundColor: '#0c0e14',
                textColor: '#848e9c',
            },
            grid: {
                vertLines: {
                    color: '#161a25',
                },
                horzLines: {
                    color: '#161a25',
                },
            },
            crosshair: {
                mode: LightweightCharts.CrosshairMode.Normal,
            },
            priceScale: {
                borderColor: '#161a25',
            },
            timeScale: {
                borderColor: '#161a25',
                timeVisible: true,
                secondsVisible: false,
            },
        });

        const candleSeries = chart.addCandlestickSeries({
            upColor: '#00b15d',
            downColor: '#f84960',
            borderDownColor: '#f84960',
            borderUpColor: '#00b15d',
            wickDownColor: '#f84960',
            wickUpColor: '#00b15d',
        });

        // Initial empty data
        candleSeries.setData([]);

        // WebSocket connection
        let ws = null;
        let tradeWs = null;
        let orderBookWs = null;
        let reconnectTimeout = null;
        let isConnected = false;
        const statusIndicator = document.getElementById('status-indicator');
        const statusText = document.getElementById('status-text');
        const connectBtn = document.getElementById('connectBtn');
        const currentPriceElement = document.getElementById('current-price');
        const orderBookPriceElement = document.getElementById('order-book-price');
        const priceChangeElement = document.getElementById('price-change');
        const tradesBody = document.getElementById('trades-body');
        const orderBookContent = document.getElementById('order-book-content');
        
        let lastPrice = 0;
        let priceHistory = [];
        let currentInterval = '1m';
        let orderBookData = { bids: [], asks: [] };

        // Binance WebSocket URLs
        const BINANCE_WS_URL = 'wss://stream.binance.com:9443/ws/btcusdt@kline_';
        const BINANCE_TRADE_WS_URL = 'wss://stream.binance.com:9443/ws/btcusdt@trade';
        const BINANCE_ORDERBOOK_WS_URL = 'wss://stream.binance.com:9443/ws/btcusdt@depth20@100ms';

        function connectWebSocket() {
            updateStatus('connecting');
            
            // Close existing connections if any
            disconnectWebSocket();
            
            // Clear any pending reconnection
            if (reconnectTimeout) {
                clearTimeout(reconnectTimeout);
                reconnectTimeout = null;
            }
            
            try {
                // Connect to Binance WebSocket for kline data
                ws = new WebSocket(`${BINANCE_WS_URL}${currentInterval}`);
                
                ws.onopen = () => {
                    console.log('Connected to Binance WebSocket');
                    isConnected = true;
                    updateStatus('connected');
                };
                
                ws.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        processKlineData(data);
                    } catch (error) {
                        console.error('Error parsing WebSocket message:', error);
                    }
                };
                
                ws.onerror = (error) => {
                    console.error('WebSocket error:', error);
                    updateStatus('error');
                };
                
                ws.onclose = () => {
                    console.log('WebSocket connection closed');
                    isConnected = false;
                    updateStatus('disconnected');
                    
                    // Try to reconnect after 5 seconds
                    reconnectTimeout = setTimeout(connectWebSocket, 5000);
                };
                
                // Connect to trade WebSocket
                tradeWs = new WebSocket(BINANCE_TRADE_WS_URL);
                tradeWs.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        processTradeData(data);
                    } catch (error) {
                        console.error('Error parsing trade WebSocket message:', error);
                    }
                };
                
                // Connect to order book WebSocket
                orderBookWs = new WebSocket(BINANCE_ORDERBOOK_WS_URL);
                orderBookWs.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        processOrderBookData(data);
                    } catch (error) {
                        console.error('Error parsing order book WebSocket message:', error);
                    }
                };
                
            } catch (error) {
                console.error('Failed to create WebSocket connection:', error);
                updateStatus('error');
                
                // Try to reconnect after 5 seconds
                reconnectTimeout = setTimeout(connectWebSocket, 5000);
            }
        }

        function disconnectWebSocket() {
            if (ws) {
                ws.close();
                ws = null;
            }
            
            if (tradeWs) {
                tradeWs.close();
                tradeWs = null;
            }
            
            if (orderBookWs) {
                orderBookWs.close();
                orderBookWs = null;
            }
            
            if (reconnectTimeout) {
                clearTimeout(reconnectTimeout);
                reconnectTimeout = null;
            }
            
            isConnected = false;
            updateStatus('disconnected');
        }

        function updateStatus(status) {
            // Remove all status classes
            statusIndicator.classList.remove('status-connected', 'status-disconnected', 'status-connecting');
            
            switch(status) {
                case 'connected':
                    statusIndicator.classList.add('status-connected');
                    statusText.textContent = 'Connected';
                    connectBtn.innerHTML = '<i class="fas fa-wifi"></i> Disconnect';
                    connectBtn.classList.remove('btn-primary');
                    connectBtn.classList.add('btn-danger');
                    break;
                case 'connecting':
                    statusIndicator.classList.add('status-connecting');
                    statusText.textContent = 'Connecting...';
                    connectBtn.innerHTML = '<i class="fas fa-wifi"></i> Connect';
                    connectBtn.classList.remove('btn-danger');
                    connectBtn.classList.add('btn-primary');
                    break;
                case 'disconnected':
                    statusIndicator.classList.add('status-disconnected');
                    statusText.textContent = 'Disconnected';
                    connectBtn.innerHTML = '<i class="fas fa-wifi"></i> Connect';
                    connectBtn.classList.remove('btn-danger');
                    connectBtn.classList.add('btn-primary');
                    break;
                case 'error':
                    statusIndicator.classList.add('status-disconnected');
                    statusText.textContent = 'Connection Error';
                    connectBtn.innerHTML = '<i class="fas fa-wifi"></i> Reconnect';
                    connectBtn.classList.remove('btn-danger');
                    connectBtn.classList.add('btn-primary');
                    break;
            }
        }

        function processKlineData(data) {
            if (data.k) {
                const kline = data.k;
                
                // Update the current price
                const price = parseFloat(kline.c);
                currentPriceElement.textContent = price.toLocaleString('en-US', { maximumFractionDigits: 2 });
                
                // Calculate price change
                const openPrice = parseFloat(kline.o);
                const change = ((price - openPrice) / openPrice) * 100;
                
                priceChangeElement.textContent = (change >= 0 ? '+' : '') + change.toFixed(2) + '%';
                priceChangeElement.className = change >= 0 ? 'change' : 'change negative';
                currentPriceElement.className = change >= 0 ? 'price' : 'price negative';
                
                // Update the chart
                const candle = {
                    time: kline.t / 1000,
                    open: openPrice,
                    high: parseFloat(kline.h),
                    low: parseFloat(kline.l),
                    close: price
                };
                
                candleSeries.update(candle);
            }
        }

        function processTradeData(trade) {
            const now = new Date(trade.T);
            const timeString = now.toLocaleTimeString();
            
            const row = document.createElement('tr');
            
            const priceCell = document.createElement('td');
            priceCell.textContent = parseFloat(trade.p).toLocaleString('en-US', { maximumFractionDigits: 2 });
            priceCell.className = trade.m ? 'negative' : 'price';
            
            const amountCell = document.createElement('td');
            amountCell.textContent = parseFloat(trade.q).toFixed(5);
            
            const timeCell = document.createElement('td');
            timeCell.textContent = timeString;
            
            row.appendChild(priceCell);
            row.appendChild(amountCell);
            row.appendChild(timeCell);
            
            tradesBody.insertBefore(row, tradesBody.firstChild);
            
            // Keep only the last 50 trades
            if (tradesBody.children.length > 50) {
                tradesBody.removeChild(tradesBody.lastChild);
            }
        }

        function processOrderBookData(data) {
            // Update order book data
            if (data.bids) {
                orderBookData.bids = data.bids.slice(0, 10); // Top 10 bids
            }
            if (data.asks) {
                orderBookData.asks = data.asks.slice(0, 10); // Top 10 asks
            }
            
            // Render order book
            renderOrderBook();
        }

        function renderOrderBook() {
            // Clear existing content
            orderBookContent.innerHTML = '';
            
            // Add sell orders (asks)
            orderBookData.asks.slice().reverse().forEach(order => {
                const price = parseFloat(order[0]);
                const amount = parseFloat(order[1]);
                const total = price * amount;
                
                const row = document.createElement('div');
                row.className = 'order-row sell';
                
                const priceElem = document.createElement('div');
                priceElem.className = 'order-price';
                priceElem.textContent = price.toLocaleString('en-US', { maximumFractionDigits: 2 });
                
                const amountElem = document.createElement('div');
                amountElem.className = 'order-amount';
                amountElem.textContent = amount.toFixed(5);
                
                const totalElem = document.createElement('div');
                totalElem.className = 'order-total';
                totalElem.textContent = total.toLocaleString('en-US', { maximumFractionDigits: 2 });
                
                row.appendChild(priceElem);
                row.appendChild(amountElem);
                row.appendChild(totalElem);
                
                orderBookContent.appendChild(row);
            });
            
            // Add current price
            const currentPriceRow = document.createElement('div');
            currentPriceRow.className = 'current-price';
            currentPriceRow.textContent = lastPrice.toLocaleString('en-US', { maximumFractionDigits: 2 });
            currentPriceRow.id = 'order-book-price';
            orderBookContent.appendChild(currentPriceRow);
            
            // Add buy orders (bids)
            orderBookData.bids.forEach(order => {
                const price = parseFloat(order[0]);
                const amount = parseFloat(order[1]);
                const total = price * amount;
                
                const row = document.createElement('div');
                row.className = 'order-row';
                
                const priceElem = document.createElement('div');
                priceElem.className = 'order-price';
                priceElem.textContent = price.toLocaleString('en-US', { maximumFractionDigits: 2 });
                
                const amountElem = document.createElement('div');
                amountElem.className = 'order-amount';
                amountElem.textContent = amount.toFixed(5);
                
                const totalElem = document.createElement('div');
                totalElem.className = 'order-total';
                totalElem.textContent = total.toLocaleString('en-US', { maximumFractionDigits: 2 });
                
                row.appendChild(priceElem);
                row.appendChild(amountElem);
                row.appendChild(totalElem);
                
                orderBookContent.appendChild(row);
            });
        }

        function changeInterval(interval) {
            currentInterval = interval;
            
            // Update active class
            document.querySelectorAll('.interval').forEach(el => {
                el.classList.remove('active');
                if (el.dataset.interval === interval) {
                    el.classList.add('active');
                }
            });
            
            // Reconnect with new interval
            if (isConnected) {
                disconnectWebSocket();
                connectWebSocket();
            }
        }

        // Connect button handler
        connectBtn.addEventListener('click', () => {
            if (isConnected) {
                disconnectWebSocket();
            } else {
                connectWebSocket();
            }
        });

        // Handle interval clicks
        document.querySelectorAll('.interval').forEach(interval => {
            interval.addEventListener('click', () => {
                changeInterval(interval.dataset.interval);
            });
        });

        // Update chart on resize
        window.addEventListener('resize', () => {
            chart.resize(
                document.getElementById('chart').clientWidth,
                document.getElementById('chart').clientHeight
            );
        });

        // Initial status
        updateStatus('disconnected');
        
        // Add some initial data for display purposes
        setTimeout(() => {
            if (!isConnected) {
                // Add sample data for demonstration
                tradesBody.innerHTML = `
                    <tr>
                        <td class="price">36,542.50</td>
                        <td>0.452</td>
                        <td>12:45:23</td>
                    </tr>
                    <tr>
                        <td class="price">36,543.20</td>
                        <td>1.241</td>
                        <td>12:45:21</td>
                    </tr>
                    <tr>
                        <td class="negative">36,540.75</td>
                        <td>0.874</td>
                        <td>12:45:18</td>
                    </tr>
                `;
                
                // Add sample order book data
                orderBookData = {
                    bids: [
                        ['36540.10', '0.321'],
                        ['36538.45', '1.542'],
                        ['36535.90', '0.875']
                    ],
                    asks: [
                        ['36550.20', '0.452'],
                        ['36548.75', '1.241'],
                        ['36545.30', '0.874']
                    ]
                };
                
                renderOrderBook();
            }
        }, 1000);
    </script>
</body>
</html>